<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.22.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="ko" class="no-js">
  <head>
    <style> 
      ::-webkit-scrollbar{ 
        width: 10px;
        height: 10px;
      }

      ::-webkit-scrollbar-track {
        width: 0px;
        background-color: #626262;
        /* border-radius: 5px; */
      }

      ::-webkit-scrollbar-thumb {
        width: 0px;
        background-color: #E2E2E2;
        border-radius: 5px;
      }

      ::-webkit-scrollbar-thumb:hover {
        width: 10px;
        height: 20px;
        /* background-color: rgba(190, 190, 190, 0.2); */
        background-color: #A2A2A2;
        border-radius: 5px;
      }

      ::-webkit-scrollbar-track:hover {
        width: 10px;
        /* background-color: rgba(150, 150, 150, 0.1); */
        background-color: #626262;
        border-radius: 5px;
        /* background: transparent; */
        /* border-radius: 10px; */
      }

      ::-webkit-scrollbar-button:start:decrement,::-webkit-scrollbar-button:end:increment {
          width:0px;
          height: 0px;
          /* background-color: rgb(14, 221, 24); */
          /* border-radius: 50%; */
      }
    </style>
    
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>[Final] PEP 647 - User-Defined Type Guards | secrett2633</title>
<meta name="description" content="Python Enhancement Proposal 647: ‘User-Defined Type Guards’에 대한 한국어 번역입니다.">


  <meta name="author" content="secrett2633">
  
  <meta property="article:author" content="secrett2633">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="ko_KR">
<meta property="og:site_name" content="secrett2633's blog">
<meta property="og:title" content="[Final] PEP 647 - User-Defined Type Guards">
<meta property="og:url" content="http://localhost:4000/python/pep/647/">


  <meta property="og:description" content="Python Enhancement Proposal 647: ‘User-Defined Type Guards’에 대한 한국어 번역입니다.">







  <meta property="article:published_time" content="2025-09-27T01:37:28+09:00">



  <meta property="article:modified_time" content="2025-09-27T01:37:28+09:00">



  

  


<link rel="canonical" href="http://localhost:4000/python/pep/647/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "secrett2633",
      "url": "http://localhost:4000/"
    
  }
</script>






<!-- end _includes/seo.html -->



  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="secrett2633's blog Feed">


<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css">

<!--[if IE]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->


    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->


    <link rel="icon" type="image/png" sizes="32x32" href="https://secrett2633.github.io/assets/images/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://secrett2633.github.io/assets/images/favicon/favicon-16x16.png">
    <meta name="msapplication-TileColor" content="#ffc40d">
    <meta name="theme-color" content="#ffffff">
  </head>

  <body class="layout--single">
    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          secrett2633's blog
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="https://github.com/secrett2633">GitHub</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <svg class="icon" width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.99 16">
            <path d="M15.5,13.12L13.19,10.8a1.69,1.69,0,0,0-1.28-.55l-0.06-.06A6.5,6.5,0,0,0,5.77,0,6.5,6.5,0,0,0,2.46,11.59a6.47,6.47,0,0,0,7.74.26l0.05,0.05a1.65,1.65,0,0,0,.5,1.24l2.38,2.38A1.68,1.68,0,0,0,15.5,13.12ZM6.4,2A4.41,4.41,0,1,1,2,6.4,4.43,4.43,0,0,1,6.4,2Z" transform="translate(-.01)"></path>
          </svg>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  

  <!-- 2022.02.17 author content hidden -->
  <!-- <div class="author__content">
    
      <h3 class="author__name" itemprop="name">secrett2633</h3>
    
    
  </div> -->

  <div class="author__urls-wrapper">
    <!-- <button class="btn btn--inverse">Follow</button> -->
    <ul class="author__urls social-icons">
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
    
      
      
      
      
    
    
      <nav class="nav__list">
  
  <input id="ac-toc" name="accordion-toc" type="checkbox" />
  <label for="ac-toc">Toggle Menu</label>
  <ul class="nav__items">
    <!-- Backend -->
    <li>
      <span class="nav__sub-title">Backend</span>
      <hr>
      <ul>
        <li><a href="/backend/django/">Django</a></li>
        <li><a href="/backend/logging/">Logging</a></li>
      </ul>
    </li>

    <!-- Python -->
    <li>
      <span class="nav__sub-title">Python</span>
      <hr>
      <ul>
        <li><a href="/python/pep/">PEP</a></li>
      </ul>
    </li>

    <!-- AI/ML -->
    <li>
      <span class="nav__sub-title">AI/ML</span>
      <hr>
      <ul>
        <li><a href="/ai/llm/">LLM</a></li>
        <li><a href="/ai/review/">Review</a></li>
      </ul>
    </li>

    <!-- DevOps -->
    <li>
      <span class="nav__sub-title">DevOps</span>
      <hr>
      <ul>
        <li><a href="/devops/nginx/">Nginx</a></li>
        <li><a href="/devops/docker/">Docker</a></li>
        <li><a href="/devops/safeline/">SafeLine</a></li>
        <li><a href="/devops/jenkins/">Jenkins</a></li>
        <li><a href="/devops/github-actions/">GitHub Actions</a></li>
        <li><a href="/devops/aws/">AWS</a></li>
      </ul>
    </li>

    <!-- etc -->
    <li>
      <span class="nav__sub-title">etc</span>
      <hr>
      <ul>
        <li><a href="/etc/me/">Me</a></li>
        <li><a href="/etc/chrome-extension/">Chrome Extension</a></li>
      </ul>
    </li>
  </ul>
</nav>
    
  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="[Final] PEP 647 - User-Defined Type Guards">
    <meta itemprop="description" content="Python Enhancement Proposal 647: ‘User-Defined Type Guards’에 대한 한국어 번역입니다.">
    <meta itemprop="datePublished" content="2025-09-27T01:37:28+09:00">
    <meta itemprop="dateModified" content="2025-09-27T01:37:28+09:00">

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">[Final] PEP 647 - User-Defined Type Guards
</h1>
          

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-calendar-alt" aria-hidden="true"></i>
        <time datetime="2025-09-27T01:37:28+09:00">September 27, 2025</time>
      </span>
    

    

    
  </p>


        </header>
      

      <section class="page__content" itemprop="text">
        
          <aside class="sidebar__right sticky">
            <nav class="toc">
              <header><h4 class="nav__title"><i class="fas fa-file-alt"></i> On this page</h4></header>
              <ul class="toc__menu"><li><a href="#초록-abstract">초록 (Abstract)</a></li><li><a href="#동기-motivation">동기 (Motivation)</a></li><li><a href="#명세-specification">명세 (Specification)</a><ul><li><a href="#typeguard-타입">TypeGuard 타입</a></li><li><a href="#하위-호환성-backwards-compatibility">하위 호환성 (Backwards Compatibility)</a></li><li><a href="#참조-구현-reference-implementation">참조 구현 (Reference Implementation)</a></li><li><a href="#기각된-아이디어-rejected-ideas">기각된 아이디어 (Rejected Ideas)</a><ul><li><a href="#데코레이터-구문-decorator-syntax">데코레이터 구문 (Decorator Syntax)</a></li><li><a href="#엄격한-좁히기-강제-enforcing-strict-narrowing">엄격한 좁히기 강제 (Enforcing Strict Narrowing)</a></li><li><a href="#조건부-typeguard-타입-적용-conditionally-applying-typeguard-type">조건부 TypeGuard 타입 적용 (Conditionally Applying TypeGuard Type)</a></li><li><a href="#임의의-매개변수-좁히기-narrowing-of-arbitrary-parameters">임의의 매개변수 좁히기 (Narrowing of Arbitrary Parameters)</a></li><li><a href="#암시적-self-및-cls-매개변수-좁히기-narrowing-of-implicit-self-and-cls-parameters">암시적 self 및 cls 매개변수 좁히기 (Narrowing of Implicit “self” and “cls” Parameters)</a></li></ul></li></ul></li></ul>

            </nav>
          </aside>
        
        <blockquote>
  <p><strong>원문 링크:</strong> <a href="https://peps.python.org/pep-0647/">PEP 647 - User-Defined Type Guards</a></p>

  <table>
    <tbody>
      <tr>
        <td><strong>상태:</strong> Final</td>
        <td><strong>유형:</strong> Standards Track</td>
        <td><strong>작성일:</strong> 07-Oct-2020</td>
      </tr>
    </tbody>
  </table>
</blockquote>

<p>PEP 647은 Python의 타입 힌팅 시스템을 강화하여, 런타임 검사에 기반한 조건부 타입 좁히기(conditional type narrowing) 기능을 사용자 정의 함수로 확장할 수 있도록 <code class="language-plaintext highlighter-rouge">TypeGuard</code>라는 새로운 개념을 도입합니다. 이 제안의 목표는 정적 타입 검사기가 런타임 시 특정 조건이 충족될 때 변수의 타입을 더 구체적으로 추론할 수 있도록 돕는 것입니다.</p>

<h2 id="초록-abstract">초록 (Abstract)</h2>
<p>이 PEP는 프로그램이 런타임 검사를 기반으로 타입 검사기가 사용하는 조건부 타입 좁히기(conditional type narrowing)에 영향을 미칠 수 있는 방법을 명시합니다.</p>

<h2 id="동기-motivation">동기 (Motivation)</h2>
<p>정적 타입 검사기는 프로그램 코드 흐름 내에서 표현식의 보다 정확한 타입을 결정하기 위해 “타입 좁히기(type narrowing)”라는 기술을 일반적으로 사용합니다. <code class="language-plaintext highlighter-rouge">if</code>나 <code class="language-plaintext highlighter-rouge">while</code> 문과 같은 조건부 코드 흐름 문을 기반으로 코드 블록 내에서 타입 좁히기가 적용될 때, 조건부 표현식을 “타입 가드(type guard)”라고 부르기도 합니다. Python 타입 검사기는 일반적으로 다양한 형태의 타입 가드 표현식을 지원합니다.</p>

<p>예를 들어, <code class="language-plaintext highlighter-rouge">is None</code> 검사를 통해 <code class="language-plaintext highlighter-rouge">Optional[str]</code> 타입의 <code class="language-plaintext highlighter-rouge">val</code>이 <code class="language-plaintext highlighter-rouge">str</code>로 좁혀지거나 <code class="language-plaintext highlighter-rouge">None</code>으로 좁혀질 수 있습니다. 또한 <code class="language-plaintext highlighter-rouge">isinstance</code>를 사용하여 <code class="language-plaintext highlighter-rouge">Union[str, float]</code> 타입의 <code class="language-plaintext highlighter-rouge">val</code>이 <code class="language-plaintext highlighter-rouge">str</code> 또는 <code class="language-plaintext highlighter-rouge">float</code>으로 좁혀질 수 있습니다.</p>

<p>하지만 정적 정보만으로는 타입 좁히기를 적용할 수 없는 경우가 있습니다. 예를 들어, 리스트의 모든 요소가 문자열인지 확인하는 <code class="language-plaintext highlighter-rouge">is_str_list</code> 함수를 정의하고, 이 함수가 <code class="language-plaintext highlighter-rouge">True</code>를 반환할 때 리스트를 <code class="language-plaintext highlighter-rouge">List[str]</code>로 취급하려 할 경우, 타입 검사기는 정적으로 이를 검증할 정보가 부족하여 오류를 보고합니다.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">is_str_list</span><span class="p">(</span><span class="n">val</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">object</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="sh">"""</span><span class="s">리스트의 모든 객체가 문자열인지 판단합니다.</span><span class="sh">"""</span>
    <span class="k">return</span> <span class="nf">all</span><span class="p">(</span><span class="nf">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">val</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">func1</span><span class="p">(</span><span class="n">val</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">object</span><span class="p">]):</span>
    <span class="k">if</span> <span class="nf">is_str_list</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s"> </span><span class="sh">"</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">val</span><span class="p">))</span> <span class="c1"># Error: invalid type
</span></code></pre></div></div>

<p>이 PEP는 <code class="language-plaintext highlighter-rouge">is_str_list</code>와 같은 함수를 “사용자 정의 타입 가드(user-defined type guard)”로 정의하는 방법을 도입합니다. 이를 통해 코드에서 타입 검사기가 지원하는 타입 가드를 확장할 수 있습니다.</p>

<p>새로운 메커니즘을 사용하면 <code class="language-plaintext highlighter-rouge">is_str_list</code> 함수의 반환 타입을 <code class="language-plaintext highlighter-rouge">bool</code>에서 <code class="language-plaintext highlighter-rouge">TypeGuard[List[str]]</code>로 변경하여, 함수가 <code class="language-plaintext highlighter-rouge">True</code>를 반환할 경우 입력 인수가 지정된 타입(<code class="language-plaintext highlighter-rouge">List[str]</code>)임을 나타낼 수 있습니다.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">typing</span> <span class="kn">import</span> <span class="n">TypeGuard</span>

<span class="k">def</span> <span class="nf">is_str_list</span><span class="p">(</span><span class="n">val</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">object</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">TypeGuard</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
    <span class="sh">"""</span><span class="s">리스트의 모든 객체가 문자열인지 판단합니다.</span><span class="sh">"""</span>
    <span class="k">return</span> <span class="nf">all</span><span class="p">(</span><span class="nf">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">val</span><span class="p">)</span>
</code></pre></div></div>

<p>사용자 정의 타입 가드는 <code class="language-plaintext highlighter-rouge">TypedDict</code>의 타입 요구 사항을 준수하는지 여부를 결정하는 데도 사용될 수 있습니다.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">typing</span> <span class="kn">import</span> <span class="n">TypedDict</span><span class="p">,</span> <span class="n">TypeGuard</span>

<span class="k">class</span> <span class="nc">Person</span><span class="p">(</span><span class="n">TypedDict</span><span class="p">):</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">age</span><span class="p">:</span> <span class="nb">int</span>

<span class="k">def</span> <span class="nf">is_person</span><span class="p">(</span><span class="n">val</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="sh">"</span><span class="s">TypeGuard[Person]</span><span class="sh">"</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="nf">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">[</span><span class="sh">"</span><span class="s">name</span><span class="sh">"</span><span class="p">],</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="nf">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">[</span><span class="sh">"</span><span class="s">age</span><span class="sh">"</span><span class="p">],</span> <span class="nb">int</span><span class="p">)</span>
    <span class="k">except</span> <span class="nb">KeyError</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">False</span>

<span class="k">def</span> <span class="nf">print_age</span><span class="p">(</span><span class="n">val</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
    <span class="k">if</span> <span class="nf">is_person</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Age: </span><span class="si">{</span><span class="n">val</span><span class="p">[</span><span class="sh">'</span><span class="s">age</span><span class="sh">'</span><span class="p">]</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Not a person!</span><span class="sh">"</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="명세-specification">명세 (Specification)</h2>

<h3 id="typeguard-타입"><code class="language-plaintext highlighter-rouge">TypeGuard</code> 타입</h3>
<p>이 PEP는 <code class="language-plaintext highlighter-rouge">typing</code> 모듈에서 <code class="language-plaintext highlighter-rouge">TypeGuard</code> 심볼을 도입합니다. <code class="language-plaintext highlighter-rouge">TypeGuard</code>는 단일 타입 인수를 받는 특별한 형태로, 사용자 정의 타입 가드 함수의 반환 타입을 주석 처리하는 데 사용됩니다. 타입 가드 함수 내의 <code class="language-plaintext highlighter-rouge">return</code> 문은 <code class="language-plaintext highlighter-rouge">bool</code> 값을 반환해야 하며, 타입 검사기는 모든 반환 경로가 <code class="language-plaintext highlighter-rouge">bool</code>을 반환하는지 확인해야 합니다.</p>

<p>다른 모든 면에서 <code class="language-plaintext highlighter-rouge">TypeGuard</code>는 <code class="language-plaintext highlighter-rouge">bool</code>과는 별개의 타입이며, <code class="language-plaintext highlighter-rouge">bool</code>의 하위 타입이 아닙니다. 따라서 <code class="language-plaintext highlighter-rouge">Callable[..., TypeGuard[int]]</code>는 <code class="language-plaintext highlighter-rouge">Callable[..., bool]</code>에 할당될 수 없습니다.</p>

<p><code class="language-plaintext highlighter-rouge">TypeGuard</code>가 하나 이상의 매개변수를 받는 함수나 메서드의 반환 타입을 주석 처리하는 데 사용될 때, 해당 함수 또는 메서드는 타입 검사기에 의해 사용자 정의 타입 가드로 처리됩니다. <code class="language-plaintext highlighter-rouge">TypeGuard</code>에 제공된 타입 인수는 함수에 의해 유효성이 검사된 타입을 나타냅니다.</p>

<p>사용자 정의 타입 가드는 제네릭 함수가 될 수 있습니다. 예를 들어:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">typing</span> <span class="kn">import</span> <span class="n">TypeVar</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">TypeGuard</span>

<span class="n">_T</span> <span class="o">=</span> <span class="nc">TypeVar</span><span class="p">(</span><span class="sh">"</span><span class="s">_T</span><span class="sh">"</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">is_two_element_tuple</span><span class="p">(</span><span class="n">val</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">_T</span><span class="p">,</span> <span class="p">...])</span> <span class="o">-&gt;</span> <span class="n">TypeGuard</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">_T</span><span class="p">,</span> <span class="n">_T</span><span class="p">]]:</span>
    <span class="k">return</span> <span class="nf">len</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span>

<span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">names</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="p">...]):</span>
    <span class="k">if</span> <span class="nf">is_two_element_tuple</span><span class="p">(</span><span class="n">names</span><span class="p">):</span>
        <span class="nf">reveal_type</span><span class="p">(</span><span class="n">names</span><span class="p">)</span> <span class="c1"># Tuple[str, str]
</span>    <span class="k">else</span><span class="p">:</span>
        <span class="nf">reveal_type</span><span class="p">(</span><span class="n">names</span><span class="p">)</span> <span class="c1"># Tuple[str, ...]
</span></code></pre></div></div>

<p>타입 검사기는 사용자 정의 타입 가드에 첫 번째 위치 인수로 전달된 표현식에 타입 좁히기가 적용되어야 한다고 가정합니다. 타입 가드 함수가 두 개 이상의 인수를 받는 경우, 추가 인수에 대해서는 타입 좁히기가 적용되지 않습니다.</p>

<p>타입 가드 함수가 인스턴스 메서드나 클래스 메서드로 구현된 경우, 첫 번째 위치 인수는 두 번째 매개변수(<code class="language-plaintext highlighter-rouge">self</code> 또는 <code class="language-plaintext highlighter-rouge">cls</code> 다음)에 매핑됩니다.</p>

<p>일반적으로 사용자 정의 타입 가드 함수의 반환 타입은 첫 번째 인수의 타입보다 엄격하게 “좁은(narrower)” 타입을 참조합니다. 그러나 반드시 엄격하게 좁은 타입이어야 하는 것은 아닙니다. 이는 <code class="language-plaintext highlighter-rouge">List[str]</code>가 <code class="language-plaintext highlighter-rouge">List[object]</code>의 하위 타입이 아닌 경우와 같은 상황을 허용합니다.</p>

<p>조건문이 사용자 정의 타입 가드 함수 호출을 포함하고 해당 함수가 <code class="language-plaintext highlighter-rouge">True</code>를 반환할 때, 타입 가드 함수에 첫 번째 위치 인수로 전달된 표현식은 조건부 코드 블록 내에서 추가로 좁혀지지 않는 한 <code class="language-plaintext highlighter-rouge">TypeGuard</code> 반환 타입에 지정된 타입을 갖는다고 정적 타입 검사기가 가정해야 합니다.</p>

<p>일부 내장 타입 가드는 긍정(positive) 및 부정(negative) 테스트( <code class="language-plaintext highlighter-rouge">if</code> 및 <code class="language-plaintext highlighter-rouge">else</code> 절 모두)에 대해 좁히기를 제공합니다. 그러나 사용자 정의 타입 가드는 긍정적인 경우( <code class="language-plaintext highlighter-rouge">if</code> 절)에만 좁히기를 적용하며, 부정적인 경우에는 타입이 좁혀지지 않습니다.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">typing</span> <span class="kn">import</span> <span class="n">Union</span><span class="p">,</span> <span class="n">Tuple</span>

<span class="n">OneOrTwoStrs</span> <span class="o">=</span> <span class="n">Union</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span>

<span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">val</span><span class="p">:</span> <span class="n">OneOrTwoStrs</span><span class="p">):</span>
    <span class="k">if</span> <span class="nf">is_two_element_tuple</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
        <span class="nf">reveal_type</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="c1"># Tuple[str, str]
</span>    <span class="k">else</span><span class="p">:</span>
        <span class="nf">reveal_type</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="c1"># OneOrTwoStrs
</span></code></pre></div></div>

<h3 id="하위-호환성-backwards-compatibility">하위 호환성 (Backwards Compatibility)</h3>
<p>이 새로운 기능을 사용하지 않는 기존 코드는 영향을 받지 않습니다. 특히, <code class="language-plaintext highlighter-rouge">stdlib typing</code> 라이브러리와 호환되지 않는 방식으로 어노테이션을 사용하는 코드는 <code class="language-plaintext highlighter-rouge">TypeGuard</code>를 임포트하지 않으면 됩니다.</p>

<h3 id="참조-구현-reference-implementation">참조 구현 (Reference Implementation)</h3>
<p>Pyright 타입 검사기는 이 PEP에 설명된 동작을 지원합니다.</p>

<h3 id="기각된-아이디어-rejected-ideas">기각된 아이디어 (Rejected Ideas)</h3>

<h4 id="데코레이터-구문-decorator-syntax">데코레이터 구문 (Decorator Syntax)</h4>
<p>타입 가드를 정의하기 위해 데코레이터 구문 사용이 고려되었습니다.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@type_guard</span><span class="p">(</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">is_str_list</span><span class="p">(</span><span class="n">val</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">object</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="bp">...</span>
</code></pre></div></div>

<p>하지만 데코레이터 접근 방식은 타입의 런타임 평가를 필요로 하여 전방 참조(forward references)를 불가능하게 만들므로 열등하다고 판단되었습니다. 제안된 접근 방식이 더 이해하기 쉽고 구현하기 간단하다고 여겨졌습니다.</p>

<h4 id="엄격한-좁히기-강제-enforcing-strict-narrowing">엄격한 좁히기 강제 (Enforcing Strict Narrowing)</h4>
<p><code class="language-plaintext highlighter-rouge">TypeGuard</code> 타입 인수에 지정된 타입이 첫 번째 매개변수에 지정된 타입보다 엄격하게 좁은 형태여야 한다는 엄격한 타입 좁히기 강제가 고려되었지만, 이는 이 기능의 유용한 사용 사례를 제거합니다. 예를 들어, <code class="language-plaintext highlighter-rouge">List[str]</code>가 공변성(invariance) 규칙 때문에 <code class="language-plaintext highlighter-rouge">List[object]</code>의 하위 타입이 아니기 때문에 위의 <code class="language-plaintext highlighter-rouge">is_str_list</code> 예제는 유효하지 않게 됩니다.</p>

<p>엄격한 좁히기를 강제하지 않으면 타입 안전성을 해칠 가능성이 있다는 지적이 있었지만, <code class="language-plaintext highlighter-rouge">cast</code>나 <code class="language-plaintext highlighter-rouge">Any</code>를 사용하는 등 개발자가 타입 안전성을 우회할 수 있는 다른 방법들이 많으므로, 사용자 정의 타입 가드를 구현하는 개발자는 타입 안전성에 관심이 있을 것이라고 가정하고 엄격한 검사를 생략하기로 결정했습니다.</p>

<h4 id="조건부-typeguard-타입-적용-conditionally-applying-typeguard-type">조건부 <code class="language-plaintext highlighter-rouge">TypeGuard</code> 타입 적용 (Conditionally Applying TypeGuard Type)</h4>
<p>타입 가드 함수의 첫 번째 인수로 전달된 표현식의 타입이 <code class="language-plaintext highlighter-rouge">TypeGuard</code> 반환 타입에 지정된 타입의 적절한 하위 타입인 경우, 해당 표현식은 기존 타입을 유지해야 한다는 제안이 있었습니다. 이는 복잡성과 불일치를 추가하고, 유니온(unions) 또는 여러 제약이 있는 타입 변수(type variables)와 같은 복합 타입의 경우 적절한 동작에 대한 추가적인 질문을 야기하여 기각되었습니다.</p>

<h4 id="임의의-매개변수-좁히기-narrowing-of-arbitrary-parameters">임의의 매개변수 좁히기 (Narrowing of Arbitrary Parameters)</h4>
<p>TypeScript는 사용자 정의 타입 가드에서 임의의 입력 매개변수를 좁히기 테스트에 사용할 수 있도록 허용합니다. 그러나 실제로 테스트되는 매개변수가 첫 번째 매개변수가 아닌 예시는 거의 없었으므로, Python 구현에서는 불필요한 복잡성을 추가하지 않기로 결정했습니다.</p>

<h4 id="암시적-self-및-cls-매개변수-좁히기-narrowing-of-implicit-self-and-cls-parameters">암시적 <code class="language-plaintext highlighter-rouge">self</code> 및 <code class="language-plaintext highlighter-rouge">cls</code> 매개변수 좁히기 (Narrowing of Implicit “self” and “cls” Parameters)</h4>
<p>타입 가드 함수가 인스턴스 또는 클래스 메서드로 구현된 경우, 암시적인 <code class="language-plaintext highlighter-rouge">self</code> 또는 <code class="language-plaintext highlighter-rouge">cls</code> 인수가 함수에 전달됩니다. <code class="language-plaintext highlighter-rouge">self</code> 또는 <code class="language-plaintext highlighter-rouge">cls</code>에 좁히기 로직을 적용해야 하는 경우가 있을 수 있다는 우려가 있었지만, 이는 특이한 사용 사례이며 구현을 상당히 복잡하게 만들 것이므로 특별한 조항은 두지 않기로 결정했습니다. <code class="language-plaintext highlighter-rouge">self</code> 또는 <code class="language-plaintext highlighter-rouge">cls</code>의 좁히기가 필요한 경우, 해당 값을 타입 가드 함수의 명시적 인수로 전달할 수 있습니다.</p>

<blockquote>
  <p>⚠️ <strong>알림:</strong> 이 문서는 AI를 활용하여 번역되었으며, 기술적 정확성을 보장하지 않습니다. 정확한 내용은 반드시 원문을 확인하시기 바랍니다.</p>
</blockquote>

        
      </section>

      <footer class="page__meta">
        
        
  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      <a href="/tags/#pep" class="page__taxonomy-item" rel="tag">PEP</a><span class="sep">, </span>
    
      <a href="/tags/#python" class="page__taxonomy-item" rel="tag">Python</a><span class="sep">, </span>
    
      <a href="/tags/#translation" class="page__taxonomy-item" rel="tag">Translation</a>
    
    </span>
  </p>




  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      <a href="/categories/#pep" class="page__taxonomy-item" rel="tag">PEP</a><span class="sep">, </span>
    
      <a href="/categories/#python" class="page__taxonomy-item" rel="tag">Python</a>
    
    </span>
  </p>


        
  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2025-09-27">September 27, 2025</time></p>


      </footer>

      

      
  <nav class="pagination">
    
      <a href="/python/pep/646/" class="pagination--pager" title="[Final] PEP 646 - Variadic Generics
">Previous</a>
    
    
      <a href="/python/pep/648/" class="pagination--pager" title="[Rejected] PEP 648 - Extensible customizations of the interpreter at startup
">Next</a>
    
  </nav>


    </div>

    
  </article>

</div>

    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><form class="search-content__form" onkeydown="return event.key != 'Enter';">
    <label class="sr-only" for="search">
      Enter your search term...
    </label>
    <input type="search" id="search" class="search-input" tabindex="-1" placeholder="Enter your search term..." />
  </form>
  <div id="results" class="results"></div></div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    

    
      
        
      
        
      
        
      
        
      
        
      
        
      
    

    
      <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2025 secrett2633. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>




<script src="/assets/js/lunr/lunr.min.js"></script>
<script src="/assets/js/lunr/lunr-store.js"></script>
<script src="/assets/js/lunr/lunr-en.js"></script>




    <script>
  'use strict';

  (function() {
    var commentContainer = document.querySelector('#utterances-comments');

    if (!commentContainer) {
      return;
    }

    var script = document.createElement('script');
    script.setAttribute('src', 'https://utteranc.es/client.js');
    script.setAttribute('repo', 'secrett2633/secrett2633.github.io');
    script.setAttribute('issue-term', 'pathname');
    script.setAttribute('theme', 'github-light');
    script.setAttribute('crossorigin', 'anonymous');

    commentContainer.appendChild(script);
  })();
</script>

  





  </body>
</html>
